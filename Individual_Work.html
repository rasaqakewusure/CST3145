<!DOCTYPE html>
<html lang="en">
<!--Title and header-->
<head>
    <title>Lessons - Individual Work</title>
    <style>
    </style>
    <link rel="stylesheet" href="Individual_Work.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <script src="https://unpkg.com/vue@2.7.8/dist/vue.js"></script>
    <script src="subjects.js"></script>
    </head>
<!--PRODUCT PAGE-->
    <body>
        <div id="app">
            <header>
                <u><h1 v-text="sitename"></h1></u>
                <button class="button1" @click="toggleShowProduct">
                    {{totalItemsInTheCart}}
                    <span class="fas fa-shopping-cart"></span>
                    Checkout
                </button>
            </header>

            <div v-if="showProduct">
                <main>
                    <div v-for="subject in sortedProducts">
                        <h2 v-text="subject.subject"></h2>

                        </p><p v-text="subject.location"></p>
                        <p>Price: £{{subject.price}}</p>
                        <img v-bind:src="subject.image">
                        <br>
                        <br>
                        <button v-on:click="addItemToCart" v-if="canAddToCart">Add to cart</button>
                          <button v-bind:disabled="!canAddToCart" v-else>
                            Add to cart
                            </button>
                          <span v-if="itemsLeft(subject)< 5">Only {{itemsLeft(subject)}} left!</span>
                          <span v-else-if='itemsLeft(subject) ===0'>All out!</span>
                          <span v-else>Buy now!</span>
                            <div>
                                <span v-for="n in subject.rating" id="star">★</span>
                                <span v-for="n in 5 - subject.rating" id="star">☆</span>
                            </div>
                    </div>
                    </main>
            </div>
            <!--CHECKOUT PAGE-->
            <div v-else>
                <h1>Welcome to the Checkout Page</h1>
                <p>
                    <strong>Name: </strong>
                    <input type="name" v-model.trim="order.name" required>
                </p>
                <p>
                    <strong>Phone Number: </strong>
                    <input type="phone" v-model.number="order.phone" required>
                </p>
                <p>
                    <strong>Surname: </strong>
                    <input type="surname" v-model.trim="order.surname" required>
                </p>
                <p>
                    <strong>Address:  </strong>
                    <input type="address" v-model.trim="order.address" required>
                </p>
                <p>
                    <strong>City: </strong>
                    <input type="city" v-model.trim="order.city" required>
                </p>
                <p>
                    <strong>State: </strong>
                    <select v-model="order.state">
                        <option disabled value="" >Select State</option>
                        <option v-for="(state, key) in states" v-bind:value="state">{{key}}</option>
                    </select>
                </p>
                <p>
                    <strong>Zip/Postal Code:</strong><input type="number" v-model.number="order.zip" required />
                </p>
                <p>
                    <input type="radio" id="home" value="Home" v-model="order.method">
                    <label for="home">Home</label>
                    <input type="radio" id="business" value="Business"
                    v-model="order.method">
                    <label for="business">Business</label>
                </p>
                
                <h2><u>Order Summary</u></h2>
                <p><strong>Name:  </strong>{{order.name}}</p>
                <p><strong>Phone Number:  </strong>{{order.phone}}</p>
                <p><strong>Surname:  </strong>{{order.surname}}</p>
                <p><strong>Address:  </strong>{{order.address}}</p>
                <p><strong>City:  </strong>{{order.city}}</p>
                <p><strong>State:  </strong>{{order.state}}</p>
                <p><strong>Zip/Postal Code:  </strong>{{order.zip}}</p>
                <p><strong>Method:  </strong>{{order.method}}</p>

                <button v-on:click="submitCheckout">Place Order</button>
        </div>
    </div>
        <script>
            var webstore = new Vue({
                el: '#app',
                data:{
                    sitename:"Book lessons",
                    showProduct: true,
                    subjects : subjects,
                    cart: [],
                    order:{
                        name: "",
                        phone:"",
                        surname:"",
                        address:"",
                        city: "",
                        state:"",
                        zip:"",
                        method:"Home",
                    },
                    states: {
                        AL: "Alabama",
                        AR: "Arizona",
                        CA: "California",
                        NV: "Nevada"
                    }
                },
                methods:{
                    addItemToCart : function () {
                        this.cart.push(this.subjects.id)
                    },
                    toggleShowProduct(){
                        this.showProduct = this.showProduct ? false:  true;
                    },
                    canAddToCart(subject){
                        return this.subjects.availableInventory > this.totalItemsInTheCart;
                    },
                    submitCheckout(){
                        alert("Your order has been submitted :)")
                    },
                    itemsLeft(subject){
                        return subject.availableInventory - this.totalItemsInTheCart;
                    }

                },
                computed:  {
                    totalItemsInTheCart : function  (){
                        return this.cart.length || "";
                    },
                    sortedProducts(){
                        function compare(a,b){
                            if (a.price > b.price) return 1;
                            if (a.price < b.price) return -1;
                            return -1
                        }
                        return this.subjects.sort(compare);
                    }
                    
                }
            });

        </script>
    </body>
    </html>